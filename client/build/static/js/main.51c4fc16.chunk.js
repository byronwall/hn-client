(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{50:function(e,t,n){e.exports=n(64)},57:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t),n.d(t,"GLOBAL_DATA_LAYER",(function(){return K}));n(51);var a=n(12),r=n.n(a),o=n(0),i=n.n(o),s=n(39),c=n.n(s),l=n(18),u=n(4),d=n(40),p=n.n(d),h=n(3),m=n.n(h),f=n(13),v=n(9),g=n(7),S=n(25),y=n(11),b=n(10),k=(n(57),n(26)),O=n(19),E=n.n(O),L=n(66);function I(e){if(void 0===e)return"";var t=e.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);return t&&t[1]}var w=n(5),T=n.n(w),x=function(e){Object(y.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(v.a)(this,n),(a=t.call(this,e)).childRefs=[],e.childComments.forEach((function(e){null!==e&&(a.childRefs[e.id]=i.a.createRef())})),a}return Object(g.a)(n,[{key:"render",value:function(){var e=this,t=this.props.childComments.filter((function(e){return null!==e}));return i.a.createElement(i.a.Fragment,null,t.map((function(n,a){return i.a.createElement(D,{key:n.id,comment:n,depth:e.props.depth,canExpand:e.props.canExpand,ref:e.childRefs[n.id],onUpdateOpen:function(r,o,i){var s;return e.props.onUpdateOpen(r,o,null!==i&&void 0!==i?i:o?null===n||void 0===n?void 0:n.id:null===(s=t[a+1])||void 0===s?void 0:s.id)},isOpen:!(e.props.collapsedIds.findIndex((function(e){return null!==n&&e===n.id}))>=0),collapsedIds:e.props.collapsedIds,idToScrollTo:e.props.idToScrollTo})})))}}]),n}(i.a.Component);function j(e){var t=Math.floor((new Date).getTime()/1e3-e),n=Math.floor(t/31536e3);return n>1?n+" years":(n=Math.floor(t/2592e3))>1?n+" months":(n=Math.floor(t/86400))>1?n+" days":(n=Math.floor(t/3600))>=1?n+" hour"+(n>1?"s":""):(n=Math.floor(t/60))>1?n+" minutes":Math.floor(t)+" seconds"}var R=["#bc8672","#c5be53","#d46850","#8c7f3b","#dec392","#c9893a"],D=function(e){Object(y.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(v.a)(this,n),(a=t.call(this,e)).divRef=void 0,a.state={expandSelf:!1},a.divRef=i.a.createRef(),a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){this.scrollIfDesired()}},{key:"componentDidUpdate",value:function(){this.scrollIfDesired()}},{key:"scrollIfDesired",value:function(){var e;if(this.props.idToScrollTo===(null===(e=this.props.comment)||void 0===e?void 0:e.id)){var t,n=null===(t=this.divRef.current)||void 0===t?void 0:t.offsetTop;console.log("scrolling to me",n),void 0!==n&&window.scrollTo({behavior:"smooth",top:n-80})}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.canExpand?null:{expandSelf:!1}}}]),Object(g.a)(n,[{key:"getDivRef",value:function(){return this.divRef.current}},{key:"render",value:function(){var e=this,t=this.props.comment;if(null===t)return null;var n=(t.kidsObj||[]).filter(C),a=t.text||"";if(!C(t))return null;var r=this.props.isOpen?i.a.createElement(i.a.Fragment,null,i.a.createElement("p",{className:"comment",dangerouslySetInnerHTML:{__html:a}}),n.length>0&&i.a.createElement(x,{childComments:n,canExpand:this.props.canExpand&&!this.state.expandSelf,depth:this.props.depth+1,onUpdateOpen:function(t,n,a){return e.props.onUpdateOpen(t,n,a)},collapsedIds:this.props.collapsedIds,idToScrollTo:this.props.idToScrollTo})):null,o=this.props.depth<R.length?R[this.props.depth]:"#bbb";return i.a.createElement("div",{className:T()("bp3-card",{collapsed:!this.props.isOpen}),onClick:function(t){return e.handleCardClick(t)},style:{paddingLeft:12+Math.max(4-this.props.depth),marginLeft:this.state.expandSelf&&this.props.isOpen?-17*this.props.depth:0,borderLeftColor:o,borderLeftWidth:this.state.expandSelf?6:void 0,borderRight:this.state.expandSelf?"1px solid"+o:void 0,paddingRight:this.state.expandSelf?6:void 0}},i.a.createElement("p",{style:{fontWeight:this.props.isOpen?450:300},ref:this.divRef},t.by," | ",j(t.time)," ago"),r)}},{key:"handleCardClick",value:function(e){if(e.stopPropagation(),"A"!==e.target.tagName){var t=e.target,n=this.state.expandSelf?.85:.9;if(this.props.depth>0&&this.props.canExpand&&(e.pageX+t.offsetLeft)/window.innerWidth>n)this.setState({expandSelf:!this.state.expandSelf});else{var a=!this.props.isOpen;if(null===this.props.comment)return;this.props.onUpdateOpen(this.props.comment.id,a,void 0)}}}}]),n}(i.a.Component);function C(e){return null!==e&&!(e.deleted&&(void 0===e.kidsObj||0===e.kidsObj.length))}var N,_,F=function(e){Object(y.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(v.a)(this,n),(a=t.call(this,e)).state={collapsedComments:[],idToScrollTo:void 0,data:void 0},a.anchorClickHandler=a.anchorClickHandler.bind(Object(S.a)(a)),a}return Object(g.a)(n,[{key:"render",value:function(){var e=this;if(!this.state.data)return null;this.state.idToScrollTo&&this.setState({idToScrollTo:void 0});var t=this.state.data,n=void 0===t.url?i.a.createElement("span",null,t.title):i.a.createElement("a",{href:t.url},t.title),a=(t.kidsObj||[]).filter(C);return document.title="HN: ".concat(t.title),i.a.createElement("div",null,i.a.createElement(L.a,{style:{overflowWrap:"break-word"}},n),i.a.createElement(L.b,null,i.a.createElement("span",null,t.by),i.a.createElement("span",null," | "),i.a.createElement("span",null,t.score," points"),i.a.createElement("span",null," | "),i.a.createElement("span",null,j(t.time)," ago"),i.a.createElement("span",null," | "),i.a.createElement("span",null,I(t.url))),void 0!==t.text&&i.a.createElement("p",{className:"top-text",dangerouslySetInnerHTML:{__html:t.text}}),i.a.createElement(x,{childComments:a,canExpand:!0,depth:0,collapsedIds:this.state.collapsedComments,onUpdateOpen:function(t,n,a){return e.handleCollapseEvent(t,n,a)},idToScrollTo:this.state.idToScrollTo}))}},{key:"handleCollapseEvent",value:function(e,t,n){if(t){var a=E.a.cloneDeep(this.state.collapsedComments);E.a.remove(a,(function(t){return t===e})),sessionStorage.setItem("SESSION_COLLAPSED",JSON.stringify(a)),this.setState({collapsedComments:a})}else{var r=this.state.collapsedComments.concat(e);sessionStorage.setItem("SESSION_COLLAPSED",JSON.stringify(r)),this.setState({collapsedComments:r})}void 0!==n&&this.setState({idToScrollTo:n})}},{key:"componentDidMount",value:function(){window.scrollTo({top:0}),document.body.addEventListener("click",this.anchorClickHandler);var e=sessionStorage.getItem("SESSION_COLLAPSED");if(null!==e){var t=JSON.parse(e);this.setState({collapsedComments:t})}void 0!==this.props.id&&this.props.onVisitMarker(this.props.id),this.loadStoryData()}},{key:"componentDidUpdate",value:function(e){this.props.id!==e.id&&this.loadStoryData()}},{key:"loadStoryData",value:function(){var e=Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.props.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,K.getStoryData(this.props.id);case 4:t=e.sent,this.setState({data:t});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("click",this.anchorClickHandler)}},{key:"anchorClickHandler",value:function(e){if("A"===e.target.tagName){var t=e.target,n=t.href.match(/https?:\/\/news\.ycombinator\.com\/item\?id=(\d+)/);if(null!==n)return this.props.history.push("/story/"+n[1]),e.preventDefault(),!1;t.target="_blank"}}}]),n}(i.a.Component),A=function(e){Object(y.a)(n,e);var t=Object(b.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this)).pendingReadItems=[],e.initializeFromLocalStorage(),e.state={isLoadingNewData:!1,activeList:[],isLoadingLocalStorage:!0,readItems:{},activeListType:void 0,storyKey:0},e}return Object(g.a)(n,[{key:"initializeFromLocalStorage",value:function(){var e=Object(f.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loading from local storage"),this.setState({isLoadingLocalStorage:!0}),e.next=4,r.a.getItem("STORAGE_READ_ITEMS");case 4:t=e.sent,console.log("loaded from local storage"),this.setState({isLoadingLocalStorage:!1,readItems:null!==t&&void 0!==t?t:{}}),this.pendingReadItems.forEach((function(e){return n.saveIdToReadList(e)})),this.pendingReadItems=[],void 0!==this.state.activeListType&&this.updateActiveList(this.state.activeListType),this.pruneLocalStorage();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pruneLocalStorage",value:function(){var e=Object(f.a)(m.a.mark((function e(){var t,n,a,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.keys();case 2:return t=e.sent,n=t.filter((function(e){return e.startsWith("STORIES_")})).map((function(e){return r.a.getItem(e)})),e.next=6,Promise.all(n);case 6:a=e.sent,o=E.a.flatten(a).map((function(e){return e.id+""})),i=t.filter((function(e){return!e.startsWith("STORIES_")})).filter((function(e){return"STORAGE_READ_ITEMS"!==e})).filter((function(e){return!E.a.includes(o,e)})),console.log("going to prune",i),i.forEach((function(e){return r.a.removeItem(e)}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"saveIdToReadList",value:function(e){if(this.state.isLoadingLocalStorage)return console.log("do not update read list... pending updates"),void this.pendingReadItems.push(e);var t=E.a.cloneDeep(this.state.readItems);console.log("new read list",t),t[e]||(t[e]=!0,r.a.setItem("STORAGE_READ_ITEMS",t),this.setState((function(e){return{readItems:t}})))}},{key:"getStoryData",value:function(){var e=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.getItem(t+"");case 2:if(null===(n=e.sent)){e.next=5;break}return e.abrupt("return",n);case 5:return e.next=7,this.getStoryFromServer(t);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStoryFromServer",value:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/story/"+t,this.updateIsLoadingStatus(!0),e.next=4,fetch(n);case 4:if((a=e.sent).ok){e.next=8;break}return console.error(a),e.abrupt("return",void 0);case 8:return e.next=10,a.json();case 10:if(!("error"in(o=e.sent))){e.next=15;break}return console.error(o),this.updateIsLoadingStatus(!1),e.abrupt("return",void 0);case 15:return console.log("hn item from server",o),this.updateIsLoadingStatus(!1),r.a.setItem(t+"",o),e.abrupt("return",o);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateIsLoadingStatus",value:function(e){this.setState({isLoadingNewData:e})}},{key:"reloadStoryById",value:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clearItemData(t);case 2:this.setState((function(e){return{storyKey:e.storyKey+1}}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearItemData",value:function(){var e=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.getItem(t+"");case 2:if(null!==(n=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,r.a.removeItem(t+"");case 7:void 0!==n&&function(){var e=[n],t=sessionStorage.getItem("SESSION_COLLAPSED");if(null!==t){for(var a=JSON.parse(t),r=new Set(a);e.length;){var o,i=e.shift();void 0!==i&&(r.has(i.id)&&r.delete(i.id),null===(o=i.kidsObj)||void 0===o||o.filter((function(e){return null!==e})).forEach((function(t){return e.push(t)})))}var s=Array.from(r);console.log("old collapse",a,s),sessionStorage.setItem("SESSION_COLLAPSED",JSON.stringify(s))}}();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateActiveList",value:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({activeListType:t}),console.log("getpagedata",t,this.state),void 0!==t){e.next=6;break}return console.error("unknown page -> source map"),this.setState({activeList:[]}),e.abrupt("return",[]);case 6:return e.next=8,r.a.getItem("STORIES_"+t);case 8:if(null!==(n=e.sent)){e.next=13;break}return console.log("no ids to load..."),this.reloadStoryListFromServer(t),e.abrupt("return");case 13:a=n,t!==_.Front&&(a=E.a.sortBy(a,(function(e){return-e.score}))),this.setState({activeList:a});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadStoryListFromServer",value:function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("loading data"),n="",e.t0=t,e.next=e.t0===_.Front?5:e.t0===_.Day?7:e.t0===_.Week?9:e.t0===_.Month?11:13;break;case 5:return n="/topstories/topstories",e.abrupt("break",13);case 7:return n="/topstories/day",e.abrupt("break",13);case 9:return n="/topstories/week",e.abrupt("break",13);case 11:return n="/topstories/month",e.abrupt("break",13);case 13:if(!this.state.isLoadingNewData){e.next=16;break}return console.log("only have one request at a time"),e.abrupt("return");case 16:return this.updateIsLoadingStatus(!0),e.next=19,fetch(n);case 19:if((a=e.sent).ok){e.next=24;break}return console.error(a),this.updateIsLoadingStatus(!1),e.abrupt("return");case 24:return e.next=26,a.json();case 26:r=e.sent,t!==_.Front&&(r=E.a.sortBy(r,(function(e){return-e.score}))),console.log("hn items from server",r),this.updateIsLoadingStatus(!1),this.updateNewItems(r,t);case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateNewItems",value:function(e,t){console.log("items coming from server",e,t,this.state),void 0===e&&(e=[]);var n=e.map((function(e){return{id:e.id,score:e.score,title:e.title,url:e.url,commentCount:e.descendants,time:e.time}}));e.forEach((function(e){r.a.setItem(e.id+"",e)})),r.a.setItem("STORIES_"+t,n),this.setState({activeList:n})}}]),n}(k.a),P=n(67),M=n(43),W=n(68),Y=function(e){Object(y.a)(n,e);var t=Object(b.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement(P.a,{style:{marginBottom:10}},i.a.createElement(P.a.Group,null,i.a.createElement(l.b,{to:"/",className:"bp3-button bp3-minimal  header-link"},i.a.createElement(P.a.Heading,{style:{display:"flex",alignItems:"center"}},i.a.createElement("img",{src:"/favicon-32x32.png"}),i.a.createElement("span",{style:{marginLeft:3,color:"#5C7080"}},"offline"))),i.a.createElement(l.c,{to:"/day",className:"bp3-button bp3-minimal  header-link",activeClassName:"bp3-active bp3-intent-primary"},"day"),i.a.createElement(l.c,{to:"/week",className:"bp3-button bp3-minimal  header-link",activeClassName:"bp3-active bp3-intent-primary"},"week")),i.a.createElement(P.a.Group,{align:"right"},this.props.isLoading&&i.a.createElement(M.a,{size:32,intent:"warning"}),!this.props.isLoading&&i.a.createElement(W.a,{intent:"primary",onClick:function(){return e.props.requestNewData()},icon:"refresh",minimal:!0})))}}]),n}(i.a.PureComponent),U=n(31),H=function(e){Object(y.a)(n,e);var t=Object(b.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"render",value:function(){var e=this.props.data,t=i.a.createElement(i.a.Fragment,null," | ",i.a.createElement(l.b,{to:"/story/"+e.id},i.a.createElement(U.a,{icon:"comment"})," ",e.commentCount)),n=void 0===e.url?i.a.createElement(l.b,{to:"/story/"+e.id},e.title):i.a.createElement("a",{href:e.url,target:"_blank"},e.title);return i.a.createElement("div",{className:T()({isRead:this.props.isRead})},i.a.createElement("p",null,n),i.a.createElement("p",null,i.a.createElement("span",null,i.a.createElement(U.a,{icon:"chevron-up"})," "," "+e.score),void 0!==e.commentCount&&t,i.a.createElement("span",null," | "+j(e.time)+" ago"),i.a.createElement("span",null," | "+I(e.url))))}}]),n}(i.a.Component),B=function(e){Object(y.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(v.a)(this,n),(a=t.call(this,e)).state={items:[]},a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){this.scrollToPrevious()}},{key:"scrollToPrevious",value:function(){if("POP"===this.props.history.action){var e=+sessionStorage.getItem("SCROLL_LIST");isNaN(e)||(console.log("fire off scroll",e),window.scrollTo({top:e}))}}},{key:"componentWillUnmount",value:function(){console.log("save scroll pos",window.scrollY),sessionStorage.setItem("SCROLL_LIST",""+window.scrollY)}},{key:"render",value:function(){var e=this;document.title="HN: Offline";var t=0===this.props.items.length&&this.props.isLoading?i.a.createElement("div",{style:{marginTop:20}},i.a.createElement(M.a,{size:200,intent:"warning"})):null;return i.a.createElement("div",null,t,i.a.createElement("div",null,this.props.items.filter((function(e){return void 0!==e.commentCount})).map((function(t){return i.a.createElement(H,{data:t,key:t.id,isRead:e.props.readIds[t.id]})}))))}}]),n}(i.a.PureComponent);!function(e){e[e.STORY_LIST=0]="STORY_LIST",e[e.STORY=1]="STORY"}(N||(N={})),function(e){e[e.Front=0]="Front",e[e.Day=1]="Day",e[e.Week=2]="Week",e[e.Month=3]="Month"}(_||(_={}));var J=function(e){Object(y.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(v.a)(this,n),(a=t.call(this,e)).lastOpenTime=void 0,a.lastOpenTime=Date.now(),a.state={activeList:_.Front,activePage:N.STORY_LIST,activeStoryId:void 0},a.onFocus=a.onFocus.bind(Object(S.a)(a)),a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.activePage===N.STORY_LIST&&K.updateActiveList(this.state.activeList),this.lastOpenTime=Date.now(),window.addEventListener("focus",this.onFocus);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWilUnmount",value:function(){window.removeEventListener("focus",this.onFocus)}},{key:"onFocus",value:function(){var e=Date.now(),t=e-this.lastOpenTime;console.log("time since init",t,this.lastOpenTime,e),t>2e4&&(console.log("been too long... force reload from local storage in case data changed on other tabs"),K.initializeFromLocalStorage()),this.lastOpenTime=e}},{key:"componentDidUpdate",value:function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.activeList!==this.state.activeList,r=n.activePage!==this.state.activePage&&this.state.activePage===N.STORY_LIST,(a||r)&&K.updateActiveList(this.state.activeList);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return console.log("app render",window.scrollY),i.a.createElement(k.c,{to:[A]},(function(t){return i.a.createElement("div",null,i.a.createElement(Y,{requestNewData:function(){return e.requestFreshDataFromDataLayer()},isLoading:t.state.isLoadingNewData}),e.state.activePage===N.STORY&&i.a.createElement(F,{id:e.state.activeStoryId,history:e.props.history,key:e.state.activeStoryId+"-"+t.state.storyKey,onVisitMarker:function(e){return t.saveIdToReadList(e)}}),e.state.activePage===N.STORY_LIST&&i.a.createElement(B,{items:t.state.activeList,readIds:t.state.readItems,isLoading:t.state.isLoadingNewData,history:e.props.history}))}))}},{key:"requestFreshDataFromDataLayer",value:function(){switch(this.state.activePage){case N.STORY:void 0!==this.state.activeStoryId&&(console.log("reloading active story"),K.reloadStoryById(this.state.activeStoryId));break;case N.STORY_LIST:console.log("reloading active list"),K.reloadStoryListFromServer(this.state.activeList)}}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n,a,r,o=void 0;console.log("props page",e.match.params.page);var i=void 0===e.match.params.storyId?e.match.params.page:"story";switch(console.log(e.match,i),i){case"day":a=_.Day,r=N.STORY_LIST;break;case"week":a=_.Week,r=N.STORY_LIST;break;case"month":a=_.Month,r=N.STORY_LIST;break;case"story":r=N.STORY,o=+(null!==(n=e.match.params.storyId)&&void 0!==n?n:""),a=t.activeList;break;default:a=_.Front,r=N.STORY_LIST}return console.log("derived state",e.match.params,a,r,o),{activeList:a,activePage:r,activeStoryId:o}}}]),n}(i.a.Component),G=Object(u.e)(J),q=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function z(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}p.a.polyfill(),window.onerror=function(e,t,n,a,o){console.error("major error",e),r.a.clear(),document.body.innerHTML="<h1>major error occurred.  local storage cleared to avoid corruption. please refresh.</h1>"},null===localStorage.getItem("VERSION")&&r.a.clear(),localStorage.setItem("VERSION","1.0");var K=new A;c.a.render(i.a.createElement(l.a,null,i.a.createElement(u.a,{path:["/story/:storyId","/:page?"]},i.a.createElement(k.b,{inject:[K]},i.a.createElement(G,null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");q?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):z(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):z(t,e)}))}}()}},[[50,1,2]]]);
//# sourceMappingURL=main.51c4fc16.chunk.js.map