(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{51:function(e,t,a){e.exports=a(65)},58:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t),a.d(t,"GLOBAL_DATA_LAYER",(function(){return K}));a(52);var n=a(17),r=a.n(n),o=a(0),i=a.n(o),s=a(39),c=a.n(s),l=a(16),u=a(3),d=a(40),p=a.n(d),h=a(5),v=a.n(h),m=a(15),f=a(9),S=a(7),g=a(11),y=a(10),b=(a(58),a(25)),k=a(44),L=a(19),I=a.n(L),O=a(29),E=a(67);function w(e){if(void 0===e)return"";var t=e.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);return t&&t[1]}var T=a(4),x=a.n(T),j=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).childRefs=[],e.childComments.forEach((function(e){null!==e&&(n.childRefs[e.id]=i.a.createRef())})),n}return Object(S.a)(a,[{key:"render",value:function(){var e=this,t=this.props.childComments.filter((function(e){return null!==e}));return i.a.createElement(i.a.Fragment,null,t.map((function(a,n){return i.a.createElement(N,{key:a.id,comment:a,depth:e.props.depth,canExpand:e.props.canExpand,ref:e.childRefs[a.id],onUpdateOpen:function(r,o,i){var s;return e.props.onUpdateOpen(r,o,null!==i&&void 0!==i?i:o?null===a||void 0===a?void 0:a.id:null===(s=t[n+1])||void 0===s?void 0:s.id)},isOpen:!(e.props.collapsedIds.findIndex((function(e){return null!==a&&e===a.id}))>=0),collapsedIds:e.props.collapsedIds,idToScrollTo:e.props.idToScrollTo})})))}}]),a}(i.a.Component);function D(e){var t=Math.floor((new Date).getTime()/1e3-e),a=Math.floor(t/31536e3);return a>1?a+" years":(a=Math.floor(t/2592e3))>1?a+" months":(a=Math.floor(t/86400))>1?a+" days":(a=Math.floor(t/3600))>=1?a+" hour"+(a>1?"s":""):(a=Math.floor(t/60))>1?a+" minutes":Math.floor(t)+" seconds"}var C=["#bc8672","#c5be53","#d46850","#8c7f3b","#dec392","#c9893a"],N=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).divRef=void 0,n.state={expandSelf:!1},n.divRef=i.a.createRef(),n}return Object(S.a)(a,[{key:"componentDidMount",value:function(){this.scrollIfDesired()}},{key:"componentDidUpdate",value:function(){this.scrollIfDesired()}},{key:"scrollIfDesired",value:function(){var e;if(this.props.idToScrollTo===(null===(e=this.props.comment)||void 0===e?void 0:e.id)){var t,a=null===(t=this.divRef.current)||void 0===t?void 0:t.offsetTop;console.log("scrolling to me",a),void 0!==a&&window.scrollTo({behavior:"smooth",top:a-80})}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.canExpand?null:{expandSelf:!1}}}]),Object(S.a)(a,[{key:"getDivRef",value:function(){return this.divRef.current}},{key:"render",value:function(){var e=this,t=this.props.comment;if(null===t)return null;var a=(t.kidsObj||[]).filter(R),n=t.text||"";if(!R(t))return null;var r=this.props.isOpen?i.a.createElement(i.a.Fragment,null,i.a.createElement("p",{className:"comment",dangerouslySetInnerHTML:{__html:n}}),a.length>0&&i.a.createElement(j,{childComments:a,canExpand:this.props.canExpand&&!this.state.expandSelf,depth:this.props.depth+1,onUpdateOpen:function(t,a,n){return e.props.onUpdateOpen(t,a,n)},collapsedIds:this.props.collapsedIds,idToScrollTo:this.props.idToScrollTo})):null,o=this.props.depth<C.length?C[this.props.depth]:"#bbb";return i.a.createElement("div",{className:x()("bp3-card",{collapsed:!this.props.isOpen}),onClick:function(t){return e.handleCardClick(t)},style:{paddingLeft:12+Math.max(4-this.props.depth),marginLeft:this.state.expandSelf&&this.props.isOpen?-17*this.props.depth:0,borderLeftColor:o,borderLeftWidth:this.state.expandSelf?6:void 0,borderRight:this.state.expandSelf?"1px solid"+o:void 0,paddingRight:this.state.expandSelf?6:void 0}},i.a.createElement("p",{style:{fontWeight:this.props.isOpen?450:300},ref:this.divRef},t.by," | ",D(t.time)," ago"),r)}},{key:"handleCardClick",value:function(e){if(e.stopPropagation(),"A"!==e.target.tagName){var t=e.target,a=this.state.expandSelf?.85:.9;if(this.props.depth>0&&this.props.canExpand&&(e.pageX+t.offsetLeft)/window.innerWidth>a)this.setState({expandSelf:!this.state.expandSelf});else{var n=!this.props.isOpen;if(null===this.props.comment)return;this.props.onUpdateOpen(this.props.comment.id,n,void 0)}}}}]),a}(i.a.Component);function R(e){return null!==e&&!(e.deleted&&(void 0===e.kidsObj||0===e.kidsObj.length))}var A,_,M=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={collapsedComments:[],idToScrollTo:void 0},n.anchorClickHandler=n.anchorClickHandler.bind(Object(O.a)(n)),n}return Object(S.a)(a,[{key:"render",value:function(){var e=this;if(void 0===this.props.data)return null;console.log("scroll to ID",this.state.idToScrollTo);var t=this.props.data,a=void 0===t.url?i.a.createElement("span",null,t.title):i.a.createElement("a",{href:t.url},t.title),n=(t.kidsObj||[]).filter(R);return document.title="HN: ".concat(t.title),i.a.createElement("div",null,i.a.createElement(E.a,{style:{overflowWrap:"break-word"}},a),i.a.createElement(E.b,null,i.a.createElement("span",null,t.by),i.a.createElement("span",null," | "),i.a.createElement("span",null,t.score," points"),i.a.createElement("span",null," | "),i.a.createElement("span",null,D(t.time)," ago"),i.a.createElement("span",null," | "),i.a.createElement("span",null,w(t.url))),void 0!==t.text&&i.a.createElement("p",{className:"top-text",dangerouslySetInnerHTML:{__html:t.text}}),i.a.createElement(j,{childComments:n,canExpand:!0,depth:0,collapsedIds:this.state.collapsedComments,onUpdateOpen:function(t,a,n){return e.handleCollapseEvent(t,a,n)},idToScrollTo:this.state.idToScrollTo}))}},{key:"handleCollapseEvent",value:function(e,t,a){if(t){var n=I.a.cloneDeep(this.state.collapsedComments);I.a.remove(n,(function(t){return t===e})),sessionStorage.setItem("SESSION_COLLAPSED",JSON.stringify(n)),this.setState({collapsedComments:n})}else{var r=this.state.collapsedComments.concat(e);sessionStorage.setItem("SESSION_COLLAPSED",JSON.stringify(r)),this.setState({collapsedComments:r})}void 0!==a&&this.setState({idToScrollTo:a})}},{key:"componentDidMount",value:function(){window.scrollTo({top:0}),document.body.addEventListener("click",this.anchorClickHandler);var e=sessionStorage.getItem("SESSION_COLLAPSED");if(null!==e){var t=JSON.parse(e);this.setState({collapsedComments:t})}void 0!==this.props.id&&this.props.onVisitMarker(this.props.id)}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("click",this.anchorClickHandler)}},{key:"anchorClickHandler",value:function(e){if("A"===e.target.tagName){var t=e.target,a=t.href.match(/https?:\/\/news\.ycombinator\.com\/item\?id=(\d+)/);if(null!==a)return this.props.history.push("/story/"+a[1]),e.preventDefault(),!1;t.target="_blank"}}}]),a}(i.a.Component),P=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(){var e;return Object(f.a)(this,a),(e=t.call(this)).initializeFromLocalStorage(),e.state={allItems:[],currentLists:[],isLoadingNewData:!1,activeList:[],activeStory:void 0,isLoadingLocalStorage:!0,localStoragePromise:void 0,readItems:{},activeListType:void 0,activeStoryId:void 0},e}return Object(S.a)(a,[{key:"initializeFromLocalStorage",value:function(){var e=Object(m.a)(v.a.mark((function e(){var t,a,n,o,i,s,c,l,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loading from local storage"),this.setState({isLoadingLocalStorage:!0}),t=r.a.getItem("HN-ALL-ITEMS"),a=r.a.getItem("HN-DATA-LISTS"),n=r.a.getItem("STORAGE_READ_ITEMS"),o=Promise.all([t,a,n]),this.setState({localStoragePromise:o}),e.next=9,o;case 9:return i=e.sent,s=Object(k.a)(i,3),c=s[0],l=s[1],u=s[2],console.log("loaded from local storage",c,l),e.next=17,this.setState({allItems:null!==c&&void 0!==c?c:[],currentLists:null!==l&&void 0!==l?l:[],isLoadingLocalStorage:!1,localStoragePromise:void 0,readItems:null!==u&&void 0!==u?u:{}});case 17:e.sent,void 0!==this.state.activeListType&&this.updateActiveList(this.state.activeListType),void 0!==this.state.activeStoryId&&this.updateActiveStory(this.state.activeStoryId);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveIdToReadList",value:function(e){var t=I.a.cloneDeep(this.state.readItems);console.log("new read list",t),t[e]||(t[e]=!0,r.a.setItem("STORAGE_READ_ITEMS",t),this.setState({readItems:t}))}},{key:"getStoryData",value:function(){var e=Object(m.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(a=this.state.allItems.find((function(e){return e.id===t})))){e.next=3;break}return e.abrupt("return",a);case 3:return e.next=5,this.getStoryFromServer(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStoryFromServer",value:function(){var e=Object(m.a)(v.a.mark((function e(t){var a,n,r,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/api/story/"+t,this.updateIsLoadingStatus(!0),e.next=4,fetch(a);case 4:if((n=e.sent).ok){e.next=8;break}return console.error(n),e.abrupt("return",void 0);case 8:return e.next=10,n.json();case 10:if(!("error"in(r=e.sent))){e.next=15;break}return console.error(r),this.updateIsLoadingStatus(!1),e.abrupt("return",void 0);case 15:return console.log("hn item from server",r),this.updateIsLoadingStatus(!1),o=this.state.allItems.concat(r),this.setState({allItems:o}),e.abrupt("return",r);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateIsLoadingStatus",value:function(e){this.setState({isLoadingNewData:e})}},{key:"reloadStoryById",value:function(){var e=Object(m.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.clearItemData(t),e.next=3,this.getStoryData(t);case 3:a=e.sent,this.setState({activeStory:a});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearItemData",value:function(e){var t=this.state.allItems.find((function(t){return t.id===e})),a=this.state.allItems.filter((function(t){return t.id!==e}));console.log("clear item",{before:this.state.allItems.length,after:a.length}),void 0!==t&&function(){var e=[t],a=sessionStorage.getItem("SESSION_COLLAPSED");if(null!==a){for(var n=JSON.parse(a),r=new Set(n);e.length;){var o,i=e.shift();void 0!==i&&(r.has(i.id)&&r.delete(i.id),null===(o=i.kidsObj)||void 0===o||o.filter((function(e){return null!==e})).forEach((function(t){return e.push(t)})))}var s=Array.from(r);console.log("old collapse",n,s),sessionStorage.setItem("SESSION_COLLAPSED",JSON.stringify(s))}}(),this.setState({allItems:a})}},{key:"updateActiveList",value:function(){var e=Object(m.a)(v.a.mark((function e(t){var a,n,r=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({activeListType:t,activeList:[]}),console.log("getpagedata",t,this.state),void 0!==t){e.next=5;break}return console.error("unknown page -> source map"),e.abrupt("return",[]);case 5:if(!this.state.isLoadingLocalStorage){e.next=8;break}return console.log("need to wait for local storage first"),e.abrupt("return",[]);case 8:if(!this.state.localStoragePromise){e.next=13;break}return console.log("waiting on local storage to load"),e.next=12,this.state.localStoragePromise;case 12:console.log("local storage loaded");case 13:if(void 0!==(a=this.state.currentLists.find((function(e){return e.key===t})))){e.next=18;break}return console.log("no ids to load..."),this.reloadStoryListFromServer(t),e.abrupt("return");case 18:n=a.stories.map((function(e){return r.state.allItems.find((function(t){return t.id===e}))})).filter((function(e){return void 0!==e})),t!==_.Front&&(n=I.a.sortBy(n,(function(e){return-e.score}))),this.setState({activeList:n});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadStoryListFromServer",value:function(){var e=Object(m.a)(v.a.mark((function e(t){var a,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("loading data"),a="",e.t0=t,e.next=e.t0===_.Front?5:e.t0===_.Day?7:e.t0===_.Week?9:e.t0===_.Month?11:13;break;case 5:return a="/topstories/topstories",e.abrupt("break",13);case 7:return a="/topstories/day",e.abrupt("break",13);case 9:return a="/topstories/week",e.abrupt("break",13);case 11:return a="/topstories/month",e.abrupt("break",13);case 13:if(!this.state.isLoadingNewData){e.next=16;break}return console.log("only have one request at a time"),e.abrupt("return");case 16:return this.updateIsLoadingStatus(!0),e.next=19,fetch(a);case 19:if((n=e.sent).ok){e.next=24;break}return console.error(n),this.updateIsLoadingStatus(!1),e.abrupt("return");case 24:return e.next=26,n.json();case 26:r=e.sent,t!==_.Front&&(r=I.a.sortBy(r,(function(e){return-e.score}))),console.log("hn items from server",r),this.updateIsLoadingStatus(!1),this.updateNewItems(r,t);case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateNewItems",value:function(e,t){console.log("items coming from server",e,t,this.state),void 0===e&&(e=[]);var a=e.map((function(e){return e.id})),n=I.a.cloneDeep(this.state.currentLists),r=n.find((function(e){return e.key===t}));void 0===r?n.push({key:t,stories:a}):r.stories=a;var o=I.a.cloneDeep(this.state.allItems),i=[];e.forEach((function(e){var t=o.findIndex((function(t){return t.id===e.id}));if(-1===t)return o.push(e),void i.push(e);var a=o[t];a.lastUpdated>e.lastUpdated?i.push(a):(o[t]=e,i.push(e))})),this.saveNewDataToLocalStorage(o,n),this.setState({allItems:o,currentLists:n,activeList:e})}},{key:"saveNewDataToLocalStorage",value:function(e,t){r.a.setItem("HN-ALL-ITEMS",e),r.a.setItem("HN-DATA-LISTS",t)}},{key:"updateActiveStory",value:function(){var e=Object(m.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({activeStoryId:t}),void 0!==t){e.next=4;break}return this.setState({activeStory:void 0}),e.abrupt("return");case 4:if(!this.state.isLoadingLocalStorage){e.next=7;break}return console.log("will update story when local storage is ready"),e.abrupt("return");case 7:return e.next=9,this.getStoryData(t);case 9:a=e.sent,this.setState({activeStory:a});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),a}(b.a),F=a(68),Y=a(43),W=a(69),H=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(S.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement(F.a,{style:{marginBottom:10}},i.a.createElement(F.a.Group,null,i.a.createElement(l.b,{to:"/",className:"bp3-button bp3-minimal  header-link"},i.a.createElement(F.a.Heading,{style:{display:"flex",alignItems:"center"}},i.a.createElement("img",{src:"/favicon-32x32.png"}),i.a.createElement("span",{style:{marginLeft:3,color:"#5C7080"}},"offline"))),i.a.createElement(l.c,{to:"/day",className:"bp3-button bp3-minimal  header-link",activeClassName:"bp3-active bp3-intent-primary"},"day"),i.a.createElement(l.c,{to:"/week",className:"bp3-button bp3-minimal  header-link",activeClassName:"bp3-active bp3-intent-primary"},"week"),i.a.createElement(l.c,{to:"/month",className:"bp3-button bp3-minimal  header-link",activeClassName:"bp3-active bp3-intent-primary"},"month")),i.a.createElement(F.a.Group,{align:"right"},this.props.isLoading&&i.a.createElement(Y.a,{size:32,intent:"warning"}),!this.props.isLoading&&i.a.createElement(W.a,{intent:"primary",onClick:function(){return e.props.requestNewData()},icon:"refresh",minimal:!0})))}}]),a}(i.a.PureComponent),U=a(31),B=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(S.a)(a,[{key:"render",value:function(){var e=this.props.data,t=i.a.createElement(i.a.Fragment,null," | ",i.a.createElement(l.b,{to:"/story/"+e.id},i.a.createElement(U.a,{icon:"comment"})," ",e.descendants)),a=void 0===e.url?i.a.createElement(l.b,{to:"/story/"+e.id},e.title):i.a.createElement("a",{href:e.url,target:"_blank"},e.title);return i.a.createElement("div",{className:x()({isRead:this.props.isRead})},i.a.createElement("p",null,a),i.a.createElement("p",null,i.a.createElement("span",null,i.a.createElement(U.a,{icon:"chevron-up"})," "," "+e.score),void 0!==e.descendants&&t,i.a.createElement("span",null," | "+D(e.time)+" ago"),i.a.createElement("span",null," | "+w(e.url))))}}]),a}(i.a.Component),J=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={items:[]},n}return Object(S.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.history;if(console.log("story list mount",e),"POP"===e.action){var t=+sessionStorage.getItem("SCROLL_LIST");isNaN(t)||(console.log("fire off scroll",t),window.scrollTo({top:t}))}}},{key:"componentWillUnmount",value:function(){console.log("save scroll pos",window.scrollY),sessionStorage.setItem("SCROLL_LIST",""+window.scrollY)}},{key:"render",value:function(){var e=this;return document.title="HN: Offline",0===this.props.items.length&&this.props.isLoading?i.a.createElement("div",{style:{marginTop:20}},i.a.createElement(Y.a,{size:200,intent:"warning"})):i.a.createElement("div",null,this.props.items.filter((function(e){return void 0!==e.descendants})).map((function(t){return i.a.createElement(B,{data:t,key:t.id,isRead:e.props.readIds[t.id]})})))}}]),a}(i.a.Component);!function(e){e[e.STORY_LIST=0]="STORY_LIST",e[e.STORY=1]="STORY"}(A||(A={})),function(e){e[e.Front=0]="Front",e[e.Day=1]="Day",e[e.Week=2]="Week",e[e.Month=3]="Month"}(_||(_={}));var q=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={activeList:_.Front,storyKey:0,activePage:A.STORY_LIST,activeStoryId:void 0},n}return Object(S.a)(a,[{key:"componentDidMount",value:function(){var e=Object(m.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.state.activePage,e.next=e.t0===A.STORY?3:e.t0===A.STORY_LIST?5:7;break;case 3:return K.updateActiveStory(this.state.activeStoryId),e.abrupt("break",7);case 5:return K.updateActiveList(this.state.activeList),e.abrupt("break",7);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(m.a)(v.a.mark((function e(t,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.activeList!==this.state.activeList&&K.updateActiveList(this.state.activeList),a.activeStoryId!==this.state.activeStoryId&&K.updateActiveStory(this.state.activeStoryId);case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return i.a.createElement(b.c,{to:[P]},(function(t){return i.a.createElement("div",null,i.a.createElement(H,{requestNewData:function(){return e.requestFreshDataFromDataLayer()},isLoading:t.state.isLoadingNewData}),e.state.activePage===A.STORY&&i.a.createElement(M,{id:e.state.activeStoryId,history:e.props.history,key:e.state.activeStoryId+"-"+e.state.storyKey,onVisitMarker:function(e){return t.saveIdToReadList(e)},data:t.state.activeStory}),e.state.activePage===A.STORY_LIST&&i.a.createElement(J,{items:t.state.activeList,readIds:t.state.readItems,isLoading:t.state.isLoadingNewData,history:e.props.history}))}))}},{key:"requestFreshDataFromDataLayer",value:function(){switch(this.state.activePage){case A.STORY:void 0!==this.state.activeStoryId&&(console.log("reloading active story"),K.reloadStoryById(this.state.activeStoryId));break;case A.STORY_LIST:console.log("reloading active list"),K.reloadStoryListFromServer(this.state.activeList)}}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a,n,r,o=void 0;console.log("props page",e.match.params.page);var i=void 0===e.match.params.storyId?e.match.params.page:"story";switch(console.log(e.match,i),i){case"day":n=_.Day,r=A.STORY_LIST;break;case"week":n=_.Week,r=A.STORY_LIST;break;case"month":n=_.Month,r=A.STORY_LIST;break;case"story":r=A.STORY,o=+(null!==(a=e.match.params.storyId)&&void 0!==a?a:""),n=t.activeList;break;default:n=_.Front,r=A.STORY_LIST}return console.log("derived state",e.match.params,n,r,o),{activeList:n,activePage:r,activeStoryId:o}}}]),a}(i.a.Component),G=Object(u.e)(q),z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function V(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}p.a.polyfill(),window.onerror=function(e,t,a,n,o){console.error("major error",e),r.a.clear(),document.body.innerHTML="<h1>major error occurred.  local storage cleared to avoid corruption. please refresh.</h1>"},null===localStorage.getItem("VERSION")&&r.a.clear(),localStorage.setItem("VERSION","1.0");var K=new P;c.a.render(i.a.createElement(l.a,null,i.a.createElement(u.a,{path:["/story/:storyId","/:page?"]},i.a.createElement(b.b,{inject:[K]},i.a.createElement(G,null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");z?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):V(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):V(t,e)}))}}()}},[[51,1,2]]]);
//# sourceMappingURL=main.b58e2663.chunk.js.map